// Generated by CoffeeScript 1.3.3
(function() {
  var App;

  window.App = App = {};

  App.message = 'Hello World!';

  App.response = '';

  App.waiting = false;

  App.initialize = function() {
    var _this = this;
    this.$message = $("input[name='message']");
    this.$output = $('.js-output');
    return $('.js-send').on('click', function() {
      return _this.onSend();
    });
  };

  App.onSend = function() {
    var _this = this;
    if (this.waiting) {
      return false;
    }
    this.message = this.$message.val();
    if (!this.message.length) {
      return this.print("<p>Message can't be empty.</p>");
    }
    if (this.message.length > 140) {
      this.message = this.message.slice(0, 140);
    }
    return $.ajax({
      url: '/api/demo/',
      data: {
        message: this.message
      },
      beforeSend: function() {
        _this.print("<p>Waiting for response...</p>");
        return _this.waiting = true;
      },
      success: function(data) {
        var output;
        _this.response = data.message;
        output = "<p><strong>Message</strong>: " + _this.message + "</p>\n<p><strong>Response</strong>: " + _this.response + "</p>";
        _this.print(output);
        return _this.waiting = false;
      }
    });
  };

  App.print = function(html) {
    this.$output.html(html);
    return this;
  };

  $(function() {
    return App.initialize();
  });

}).call(this);
